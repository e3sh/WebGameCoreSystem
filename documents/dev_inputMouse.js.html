<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: dev/inputMouse.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: dev/inputMouse.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>﻿//InputMouse
//
/**
 * InputMouse
 * @class
 * @classdesc
 * マウスの入力を管理する機能を提供します。&lt;br>\
 * マウスの移動、ボタンのクリック、ホイールのスクロールイベントを捕捉し、&lt;br>\
 * マウスの位置、ボタンの状態、ホイールの移動量を追跡します。
 */
class inputMouse {
    /**
     * @constructor
     * @param {string} element_ID　target getElementById(element_ID);
     * @example
     * element_IDにはGameCoreでCanvasのIDが指定されます。
     */
    constructor(element_ID) {

        let state = { x: 0, y: 0, button: 0, wheel: 0 };

        let x = 0;
        let y = 0;
        let button = -1;
        let wheel = 0;

        let tr = { x: 1, y: 1, offset_x: 0 };

        let el = document.getElementById(element_ID);

        //mouseevent
        el.addEventListener("mousemove",
            function (event) {
                x = event.clientX;
                y = event.clientY;
            },
            false);

        el.addEventListener("mousedown", function (event) { button = event.button; }, false);
        el.addEventListener("mouseup", function (event) { button = -1; }, false);
        el.addEventListener("mousewheel", function (event) { wheel = event.wheelDelta; }, false);

        //firefox用ホイールコントロール
        el.addEventListener("DOMMouseScroll", function (event) { wheel = event.detail; }, false);

        /**
         * @method
         * @param {GameCore} g GameCoreインスタンス
         * @description
         * フルスクリーンモードかどうかに応じてマウス座標の変換を調整します。&lt;br>\
         * これにより、実際の画面解像度と描画Canvasの解像度が異なる場合でも&lt;br>\
         * 正確なマウス位置をゲーム内で取得できます。
        */
        this.mode = function (g) {

            if (document.fullscreenElement) {
                let cw = document.documentElement.clientWidth;
                let ch = document.documentElement.clientHeight;
                let pixr = window.devicePixelRatio;

                let scw = g.systemCanvas.width;
                let sch = g.systemCanvas.height;

                let rt = ch / sch;

                tr.x = rt; tr.y = rt; tr.offset_x = ((scw * rt) - cw) / rt / 2;
            } else {
                tr.x = 1; tr.y = 1; tr.offset_x = 0;
            }
        };

        /**
         * @typedef {object} mouseState マウス状態
         * @property {number} x x座標
         * @property {number} y y座標
         * @property {number} button ボタン状態
         * @property {number} wheel ホイール移動量
         * @example
         * button -1:何も押してない　0:左ボタン　2:右ボタン　1:ホイール
         */

        /**
         * @method
         * @returns {mouseState} マウス状態
         * @description
         * 現在のマウスの入力状態（位置、ボタン、ホイール）を返します。&lt;br>\
         * ボタンの状態とホイールの移動量は、次回の呼び出しのためにリセットされます。
         * @todo ボタン同時押しの検出の為にbuttonsを評価するようにする
         * @todo 多ボタンマウスの動作について検討
         */
        this.check = function () {

            state.x = (x / tr.x) + tr.offset_x;
            state.y = (y / tr.y);
            state.button = button;
            state.wheel = wheel;

            if (button != 0) { button = -1; }
            wheel = 0;

            return state;
        };

        /**
         * @method
         * @returns {mouseState} マウス状態
         * @description
         * 最後に記録されたマウスの入力状態を、値をリセットせずに返します。&lt;br>\
         * このメソッドは、前フレームの状態を参照したい場合や、&lt;br>\
         * 値のリセットが不要な場合に利用されます。
         */
        this.check_last = function () {
            //state.x = x * tr.x + tr.offset_x;
            //state.y = y * tr.y;
            //state.button = button;
            //state.wheel = wheel;

            return state;
        };

        /**
         * @method
         * @param {DisplayControl} ctx 表示するDisplayControlを指定
         * @description
         * 現在のマウスカーソル位置に視覚的なインジケータを描画します。&lt;br>\
         * デバッグや、カスタムカーソルを表示したい場合に利用でき、&lt;br>\
         * 描画機能を持つオブジェクトを`putFunc`で登録します
         */
        this.draw = function (ctx) {

            let st = this.check_last();

            let cl = {};
            cl.x = st.x;
            cl.y = st.y;
            cl.draw = function (device) {
                let context = device;

                context.beginPath();
                context.moveTo(this.x, this.y);
                context.lineTo(this.x + 10, this.y + 10);
                context.globalAlpha = 1.0;
                context.strokeStyle = "white"; //"black";
                context.lineWidth = 3;
                context.stroke();
            };
            ctx.putFunc(cl);
        };
    }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Beepcore.html">Beepcore</a></li><li><a href="Beepcore.noteClass.html">noteClass</a></li><li><a href="DisplayControl.html">DisplayControl</a></li><li><a href="DisplayControl.offScreenTypeC.html">offScreenTypeC</a></li><li><a href="GameAssetManager.html">GameAssetManager</a></li><li><a href="GameAssetManager.audioAsset.html">audioAsset</a></li><li><a href="GameAssetManager.imageAsset.html">imageAsset</a></li><li><a href="GameCore.html">GameCore</a></li><li><a href="GameCore.bench.html">bench</a></li><li><a href="GameSpriteControl.html">GameSpriteControl</a></li><li><a href="GameSpriteControl.SpItem.html">SpItem</a></li><li><a href="GameSpriteFontControl.html">GameSpriteFontControl</a></li><li><a href="GameTask.html">GameTask</a></li><li><a href="GameTaskControl.html">GameTaskControl</a></li><li><a href="SpItem.html">SpItem</a></li><li><a href="audioAsset.html">audioAsset</a></li><li><a href="bench.html">bench</a></li><li><a href="fontPrintControl.html">fontPrintControl</a></li><li><a href="imageAsset.html">imageAsset</a></li><li><a href="inputGamepad.html">inputGamepad</a></li><li><a href="inputKeyboard.html">inputKeyboard</a></li><li><a href="inputMouse.html">inputMouse</a></li><li><a href="inputTouchPad.html">inputTouchPad</a></li><li><a href="inputVirtualPad.html">inputVirtualPad</a></li><li><a href="noteClass.html">noteClass</a></li><li><a href="offScreenTypeC.html">offScreenTypeC</a></li><li><a href="soundControl.html">soundControl</a></li><li><a href="viewport.html">viewport</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Tue Aug 19 2025 15:22:23 GMT+0900 (日本標準時)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
